<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
    
    
<% 
String player1 = (String)session.getAttribute("player1"); 
String player2 = (String)session.getAttribute("player2"); 
%>

<!DOCTYPE html>
<html>

<head>
<meta charset="UTF-8">
<title>omok1</title>
    <link rel="stylesheet" href="reset.css" type="text/css">
    <link rel="stylesheet" href="omok.css?after">
</head>
<body>
<p>${player1 }${player2 }</p>
 <div class="realwrap">
 <div class="blakcout" id = "blakcout">   </div>
 <div class="blackin" id = "blackin">   </div>      
    <div class="wrap">
        
        <div class="pan">

            <ul class="x">
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
          
            </ul>
        </div>
        <div class="pan">
            <ul class="x">
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
          
            </ul>
        </div>
        <div class="pan">
            <ul class="x">
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
          
            </ul>
        </div>
        <div class="pan">
            <ul class="x">
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
          
            </ul>
        </div>
        <div class="pan">
            <ul class="x">
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
          
            </ul>
        </div>
        <div class="pan">
            <ul class="x">
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
          
            </ul>
        </div>
        <div class="pan">
            <ul class="x">
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
          
            </ul>
        </div>
        <div class="pan">
            <ul class="x">
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
          
            </ul>
        </div>
        <div class="pan">
            <ul class="x">
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
          
            </ul>
        </div>
        <div class="pan">
            <ul class="x">
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
          
            </ul>
        </div>
        <div class="pan">
            <ul class="x">
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
          
            </ul>
        </div>
        <div class="pan">
            <ul class="x">
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
          
            </ul>
        </div>
        <div class="pan">
            <ul class="x">
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
          
            </ul>
        </div>
        <div class="pan">
            <ul class="x">
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
          
            </ul>
        </div>
        <div class="pan">
            <ul class="x">
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
          
            </ul>
        </div>
        <div class="pan">
            <ul class="x">
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
          
            </ul>
        </div>
        <div class="pan">
            <ul class="x">
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
            </ul>
        </div>
        <div class="pan">
            <ul class="x">
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
          
            </ul>
        </div>
        <div class="pan">
            <ul class="x">
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
                <li ><img src=""></li>
            </ul>
        </div>
<!--   -->
		
        <div class="itembox">
        

            <img class = "panimg" src="../img/pan5.png">
            <div id = "blurblack">  </div>
            <div id = "blackwin"><img src="../img/blackwin.png"></div>
            <div id = "whitewin"><img src="../img/whitewin.png"></div>
        </div>

    </div>
    
    
    
        <div class="sub">
        
            <div class="timer">
                <div id="blacktimer"></div>
                <div id="whitetimer"></div>
            </div>
            <div class="logbox" id="logbox">   

            </div>

            <div class="turndollback">
                <div><img id = "turndoll" src="../img/black.png"></div>
                <p  onclick="undo()"  id = "undo" >무르기</p>
            </div>

        </div>
        
<!-- 	     <img class = "panshadow" src="../img/realshadow.png"> -->


       
       
</div>


    <script>
/*     var arr; */

    	var arr;
        var x;
        var y;
        var turn = 0;
        var whowin = "none"
        var pans = document.querySelectorAll(".x");
        
        
        //시간변수
        var blacktime;
        var whitetime;
    	
    	window.onload = function(){
    		
   /*  		var blacout = document.querySelector(".blacout");
    		blacout.style.opacity = 0; */

			var strlen = window.sessionStorage.length;

			 arr = new Array(19);

		        for (var i = 0; i < arr.length; i++) {
		            arr[i] = new Array(19);
		        }
		        
		        for (var j = 0; j < 19; j ++) {
		        	for (var i = 0; i < 19; i ++) {
		        		
		        		arr[j][i] = 0;
		        	}
		        	
		        }
			
			if (strlen == 0) {
		
				var turncnt = 0;
				sessionStorage.setItem("turncnt", turncnt);
				
				//시간설정
				
				blacktime = 100;
				whitetime = 100;
				sessionStorage.setItem("blacktime", blacktime);
				sessionStorage.setItem("whitetime", whitetime);
				
				
				//이건 나중에 수정 
				document.getElementById("blacktimer").innerHTML = "01:40";
				document.getElementById("whitetimer").innerHTML = "01:40";



				
				
				turn = 1;
	
			 
			}
			else if (strlen > 0) {
				
			
				
				
				
				turncnt = Number(sessionStorage.getItem("turncnt"));
				
				blacktime = Number(sessionStorage.getItem("blacktime"));
				whitetime = Number(sessionStorage.getItem("whitetime"));
				
				
				
				var minblk = parseInt(blacktime/60) + "";
    			var secblk = parseInt(blacktime%60) + "";
    			var timetext1 = timerlen(minblk) + ":" + timerlen(secblk);
    			
    			
				var minwht = parseInt(whitetime/60) + "";
    			var secwht = parseInt(whitetime%60) + "";
    			var timetext2 = timerlen(minwht) + ":" + timerlen(secwht);

    			document.getElementById("blacktimer").innerHTML = timetext1;
    			document.getElementById("whitetimer").innerHTML = timetext2;

				
				if (turncnt % 2 == 0) {
					turn = 1;
	
				}
				else if (turncnt % 2 == 1) {
					turn = 2;
		
				}

				for(let i = 0; i < window.sessionStorage.length; i++) {
					  // key 찾기
					  var key = window.sessionStorage.key(i);
					  
					  // value 찾기
					  var value = window.sessionStorage.getItem(key);
					  
					 
					  if (key.trim() !== 'turncnt' && key.trim() !== 'blacktime' && key.trim() !== 'whitetime') {
						  var valarr = value.split(',');
						  var x = Number(valarr[0]);
						  var y = Number(valarr[1]);
						  var turn2 = Number(valarr[2]);
						  

						
						  
						  arr[x][y] = turn2;
						  
						  
						  
						  
						// 첫번째 pan의 ul 요소 찾기
						  const firstPanUl = document.querySelectorAll('.pan')[x].querySelector('ul');

						  // 두번째 li 요소 찾기
						  const secondLi = firstPanUl.querySelectorAll('li')[y];

						  // img 요소 찾기
						  const img = secondLi.querySelector('img');

						  // src 속성 설정
						  if (turn2 == 1) {

							  img.src = '../img/black.png';
  
						  }
						  
						  else if (turn2 == 2) {

							  img.src = '../img/white.png';
	  
						  }
  
					  }

					}

			}

 			var blackout = document.querySelector(".blakcout");

		    blackout.style.opacity = 0;

    	  }
    	
    	//log 
    	
    	function logprint(turncnt, turn,x, y) {
    		
    		
    		var element = document.querySelector("#logbox");

    		// 새로운 <p> 요소를 생성합니다.
    		var newParagraph = document.createElement("p");
    		
    		var blackorwhite;
    		
    		if (Number(turn) == 1) {
    			blackorwhite = 'black';
    		}
    		else {
    			blackorwhite = 'white';
    			
    		}
    		
    		
    		if (Number(turncnt) == -1) {
    			
    			
    			newParagraph.innerHTML = "무르기";
    			
    			
    			
    			element.appendChild(newParagraph);
    			
    			
    		}
    		else {
    			
    			

        		// <p> 요소에 내용을 추가합니다.
        		newParagraph.innerHTML = turncnt + "/" + blackorwhite + "/" + x + "/" + y;

        		// 선택한 요소에 새로운 <p> 요소를 추가합니다.
        		element.appendChild(newParagraph);
    			
    			
    		}
    		
	
    	}
    	
    	
    	//timer
    	
    	function timerlen(text) {
    		
    		var outtext;
    		
    		if (text.length == 1) {
    			
    			outtext = "0" + text;
    			
    			return outtext;
    		}
    		else{
    			
    			
    			return text;
    			
    		}
	
    	}
    	

    	
    	
    	var timer = setInterval(function() {
    		
    		if (turn == 1) {
    			
    			var min = parseInt(blacktime/60) + "";
    			var sec = parseInt(blacktime%60) + "";
    		
    			var timetext = timerlen(min) + ":" + timerlen(sec);
    			
        		sessionStorage.setItem("blacktime", blacktime);
    			document.getElementById("blacktimer").innerHTML = timetext;
    			
    			
    			
    			//작업중
    			if (blacktime <= 0) {
    				
    				whowin = 'whitewin';
    				
    				ajax(whowin) ;
                    
    				document.getElementById('whitewin').style.display = 'block';
                    document.getElementById('blurblack').style.display = 'block';
                    sessionStorage.clear();
                    closefunc();
                    clearInterval(timer);
                    return;
    				
    				} 

    				if (whowin != "none") {
    					clearInterval(timer);
    				return
    				}
    			
    			
        			blacktime--;
	
    		}
    		
    		else if (turn == 2){
    			
    			
    			var min = parseInt(whitetime/60)+ "";
    			var sec = parseInt(whitetime%60)+ "";
    			
    			var timetext = timerlen(min) + ":" + timerlen(sec);
    			
    			sessionStorage.setItem("whitetime", whitetime);
    			document.getElementById("whitetimer").innerHTML = timetext;

    			if (whitetime <= 0){
    				
					whowin = 'blackwin';
    				
    				ajax(whowin) ;
    				
    				document.getElementById('blackwin').style.display = 'block';
                    document.getElementById('blurblack').style.display = 'block';
                    sessionStorage.clear();
                    closefunc();
                    clearInterval(timer);
                    return;
	
    			}
    			
    			if (whowin != "none") {
    				clearInterval(timer);
    				return;
    			}
    			whitetime--;
	
    		}

		}, 1000);
 

        //승리판단로직
        function iswin() {
            var cnt = 0;//각 for문 마다 연속돌 새는거
            var flag = turn == 1? "black" : "white";

            //garo
            for(var i = 0; i < 19; i++) {
                if (Number(arr[x][i]) == turn) {
                    cnt += 1;
                    if (cnt >= 5) {
                        whowin = flag + "win" // 연속돌 5개면 flag(black or white) + win 문자열 생성  whowin = 전역변수임
                        return;
                    }
                }
                else {
                    cnt = 0
                }
            }
            //sero
            for(var j = 0 ; j < 19; j ++) {
                if (Number(arr[j][y]) == turn) {
                    cnt += 1;
                    if (cnt >= 5) {
                        whowin = flag + "win"
                    }
                }
                else {
                    cnt = 0
                }
            }

            //  \left\
            for(var i=0;i<=10;i++) {
    		var indexX = x-4+i;
			var indexY = y-4+i;
			//Number(arr[x][i]) == turn
			if(0<=indexX && indexX<=18 && 0<=indexY && indexY<=18) {
				if(Number(arr[indexX][indexY]) == turn) {
					cnt+=1;
					
					if (cnt >= 5) {
                        whowin = flag + "win"
                    }

				}else {
					cnt = 0;
				}
			}
    	}
            // /right/
            for(var i=0;i<=10;i++) {
    		var indexX = x-4+i;
			var indexY = y+4-i;
			if(0<=indexX && indexX<=18 && 0<=indexY && indexY<=18) {
				if(Number(arr[indexX][indexY]) == turn) {
					cnt+= 1;
					if (cnt >= 5) {
                        whowin = flag + "win"
                    }
				}else {
					cnt = 0;
				}
			}
    	}
        }
  
        function ajax(whowin) {
        	var xhr = new XMLHttpRequest(); //XMLHttpRequest객체 생성
/*         	var blackplayer = player1;
        	var whiteplayer = player2; */
        	var whowinsend = whowin;
        	var url = '/omokgame2/game/game.do?whowinsend=' + whowinsend; /* + '&whiteplayer=' + whiteplayer + '&whowinsend=' + whowinsend; */
        	xhr.open('GET', url, true); //open(방식,url,비동기(true)동기(false))
        	xhr.send();//전송임
        	xhr.onload = () => {
        		if(xhr.status == 200) {
        			console.log(xhr.response);
        			
        		} else {
        			console.log('false');
        		}
        	}
        }
        
        
        function undo() {
        	
        	var turncnt = Number(sessionStorage.getItem("turncnt"));
        	
        	
        	if (turncnt > 0) {
        		
        		var arridx = 'arr' + turncnt;
            	var sessarr = sessionStorage.getItem(arridx);
            	var valarr = sessarr.split(',');
            	var undox = Number(valarr[0]);
            	var undoy = Number(valarr[1]);
            	var undoturn = Number(valarr[2]);
     
            	
            	arr[undox][undoy] = 0; 
            	
            	
            	
            	 const firstPanUl = document.querySelectorAll('.pan')[undox].querySelector('ul');
            	 
            	 const secondLi = firstPanUl.querySelectorAll('li')[undoy];
            	 
            	 const img = secondLi.querySelector('img');
            	 
            	 img.src = '';

    	/* 		  // 두번째 li 요소 찾기
    			  

    			  // img 요소 찾기
    			  const img = secondLi.querySelector('img');
    			  
    			  img.src = '';  */
    			  
    			
    			turncnt = turncnt - 1;
    			sessionStorage.setItem("turncnt", turncnt);
            	
            	if (undoturn == 1) {
            		
            		turn = 1;
            	}
            	else if (undoturn == 2) {
            		turn = 2;
            		
            	}
            	
            	sessionStorage.removeItem(arridx);
            	logprint(-1,0,0,0);

        	}

		}
        function handleTransitionEnd() {
        	 window.location.href = '/omokgame2/game/preboard.do';
        	
        	
        }
        
        
        function closefunc() {
        	  // 클릭 이벤트 핸들러 등록을 지연시키기 위해 setTimeout 함수.
        	  setTimeout(function() {
        	    document.addEventListener('click', function() {
        	       sessionStorage.clear();
        	       
        	       
        	       
        	       var blackin = document.querySelector(".blackin");
        	       blackin.style.opacity = 1;
        	       
        	       blackin.addEventListener("transitionend", handleTransitionEnd);

        	      
        	    });
        	  }, 0.5);
        	}
        

        pans.forEach(e => { //클릭시 이벤트 발생
            e.onclick = (e1) => {
                // dup처리 포함

                
                
                if (turn == 1 && e1.target.firstChild.src != "") { //만약 흑turn 이면서 둘곳이 빈자리가 아닐떄 

                    document.getElementById('turndoll').src = '../img/white.png';  //턴 표시해주는 돌을 흑돌 이미지 표시해주고
                    
                    var nodes = [...e1.target.parentElement.children];  // 인덱스 관련 nodes변수에 이벤트 타겟 부모 요소 찾아가서 다시 자식요소들 list에 담기
                    var nodes2 = [...e1.target.parentElement.parentElement.parentElement.children]; // 상동 */
                    y = nodes.indexOf(e1.target);//위에 담은 list중에 이벤트 타겟과 같은 아이를 찾고 그 인덱스 변수에 저장
                    x = nodes2.indexOf(e1.target.parentElement.parentElement);

                    arr[x][y] = 1;
                    e1.target.firstChild.src = '../img/black.png';   // 비어있는 img src에 흑돌이미지 경로 넣어주기

                    iswin();

                if (whowin != "none") { // 만약 iswin() 로직이 전역변수 "none" 을 변경 시켰을 때 (누군가 승리했을떄) 이유: 흑이 뒀는때 백이 이길순 없음
                        document.getElementById('blackwin').style.display = 'block';   //승리 display속성 block
                        document.getElementById('blurblack').style.display = 'block';
                        
                        //효과
                        ajax(whowin) ;
                        
                        
                        sessionStorage.clear();
                        closefunc();
                        return;     

                }
                turncnt = Number(sessionStorage.getItem("turncnt"));
                
       
                
                turncnt += 1;
                sessionStorage.setItem('turncnt', turncnt);
 
                var arridx = 'arr' + turncnt;
                var arridxval = x+','+y+','+turn;
              /*   var arridxval2 =JSON.stringify(arridxval); */
                	
				sessionStorage.setItem(arridx, arridxval); 

                sessionStorage.setItem("blacktime", blacktime);
				

               //temp
                logprint(turncnt, turn,x, y);
                turn=2;	
                
                }
                else if(turn==2 && e1.target.firstChild.src != ""){
                	
                	
                    document.getElementById('turndoll').src = '../img/black.png';
                    var nodes = [...e1.target.parentElement.children];
                    var nodes2 = [...e1.target.parentElement.parentElement.parentElement.children];
                    y = nodes.indexOf(e1.target);
                    x = nodes2.indexOf(e1.target.parentElement.parentElement);
                    arr[x][y] = 2;
                    e1.target.firstChild.src = "../img/white.png";
                    
                
                    
                    
                    iswin();
             
                    /* doPass(x, y); */
                    if (whowin != "none") {
      
                        document.getElementById('whitewin').style.display = 'block';
                        document.getElementById('blurblack').style.display = 'block';
              
                        ajax(whowin) ;
                        
                        sessionStorage.clear();
                        closefunc();
                        
                        
                        return;
                    }
                    
                    turncnt = Number(sessionStorage.getItem("turncnt"));
                    
                  
                    
                    turncnt += 1;
                    sessionStorage.setItem('turncnt', turncnt);
     
                    var arridx = 'arr' + turncnt;
                    var arridxval = x+','+y+','+turn;

					sessionStorage.setItem(arridx, arridxval); 

    				 
                    sessionStorage.setItem("whitetime", whitetime);
    				 
                    
                    logprint(turncnt, turn,x, y);
                    turn = 1;
                }else{}
           
            }
    
        })

    </script>
    


</body>
</html>